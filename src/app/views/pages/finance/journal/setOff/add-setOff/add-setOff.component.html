<kt-portlet>
	<kt-portlet-header [title]="getComponentTitle()" [class]="'kt-portlet__head--lg'" [viewLoading$]="loading$">
		<ng-container ktPortletTools>
			<a [routerLink]="['/setOff']" class="btn btn-primary kt-margin-r-10" color="primary" mat-raised-button>
				<!-- <i class="la la-arrow-left"></i> -->
				<span class="kt-hidden-mobile">Back</span>
			</a>
			<button class="btn btn-primary kt-margin-r-10" color="primary" (click)="onSubmit(false)" mat-raised-button
				[disabled]="loading.submit">
				<span class="kt-hidden-mobile">Save</span>
			</button>

		</ng-container>
	</kt-portlet-header>

	<kt-portlet-body>
		<div *ngIf="setOff">
			<form [formGroup]="setOffForm" class="kt-form kt-form--group-seperator-dashed">
				<kt-alert *ngIf="hasFormErrors" type="warn" [showCloseButton]="true" [duration]="10000"
					(close)="onAlertClose($event)">
					Oh snap! Change a few things up and try
					submitting again.
				</kt-alert>
				<div class="kt-form__section kt-form__section--first">
					<div class="row">
						<div class="col-lg-4 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput [matDatepicker]="crtdt" placeholder="Date" formControlName="date" (click)="crtdt.open()"
									autocomplete="off" />
								<mat-datepicker-toggle matSuffix [for]="crtdt"></mat-datepicker-toggle>
								<mat-datepicker #crtdt></mat-datepicker>
								<mat-error>Date is
									<strong>required</strong>
								</mat-error>
							</mat-form-field>
						</div>

						<!-- Select Voucher Number Start -->
						<div class="col-lg-4 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input type="text" matInput placeholder="Select Voucher AR" [formControl]="viewVoucherResult"
									[matAutocomplete]="csmrAuto" (keyup)="_onKeyupVoucher($event)">
								<mat-error>Fill input by selecting the given items</mat-error>
								<div *ngIf="loadingData.voucher" class="form-loader">
									<mat-spinner [diameter]="10"></mat-spinner>
								</div>
								<mat-autocomplete #csmrAuto="matAutocomplete">
									<mat-option *ngFor="let item of VoucherResultFiltered"
										value="{{item.voucherno | titlecase}} - {{item.unit2 | titlecase}}"
										(click)="_setVoucherValue(item)">
										{{item.voucherno | titlecase }} - {{item.unit2 | titlecase}}
									</mat-option>
								</mat-autocomplete>
							</mat-form-field>
						</div>

						<div class="col-lg-4 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput placeholder="Saldo Voucher" formControlName="saldoVoucher" readonly />
								<mat-error>Saldo Voucher is
									<strong>required</strong>
								</mat-error>
							</mat-form-field>
						</div>

						<!-- Select Voucher Number End -->

					</div>
					<div class="row mt-5 mb-4">
						<div class="col-lg-4 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput placeholder="Description Title" formControlName="payFrom" />
							</mat-form-field>
						</div>
						<div class="col-lg-1 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput placeholder="Currency" formControlName="rate" />
							</mat-form-field>
						</div>

						<div class="col-lg-3 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput placeholder="Total tagihan voucher no" formControlName="totalTagihan" readonly />
							</mat-form-field>
						</div>
						<div class="col-lg-4 kt-margin-bottom-10-mobile">
							<mat-form-field class="mat-form-field-fluid example-chips">
								<!-- <mat-select placeholder="Voucherno" formControlName="voucherno">
									<mat-option>--</mat-option>
									<mat-option *ngFor="let list of vouchernoList; let id = index" [value]="list"
										[ngClass]="isSelected(list, 'Voucherno')" (click)="selectList(list, 'Voucherno')">{{ list.itemName
										}}
									</mat-option>
								</mat-select>
								<mat-error>
									Voucherno is
									<strong>required</strong>
								</mat-error> -->
								<input type="text" matInput placeholder="Voucher No" [formControl]="viewVoucherNoResult"
									[matAutocomplete]="voucherAuto" (keyup)="_onKeyupVoucherNo($event)">
								<mat-error>Fill input by selecting the given items</mat-error>
								<div *ngIf="loadingData.voucher" class="form-loader">
									<mat-spinner [diameter]="10"></mat-spinner>
								</div>
								<mat-autocomplete #voucherAuto="matAutocomplete">
									<mat-option *ngFor="let list of VoucherNoResultFiltered; let id = index" value="{{ list.billing_number
									}}" [ngClass]="isSelected(list, 'Voucherno')" (click)="selectList(list, 'Voucherno')">{{ list.billing_number
										}}
									</mat-option>
								</mat-autocomplete>
							</mat-form-field>

							<mat-chip-list #chipList aria-label="Voucherno selection">
								<mat-chip *ngFor="let list of selectedVoucherno; let last = last"
									(removed)="deleteList(list._id, 'Voucherno', list)" color="primary" selected>
									{{list.billing_number}}
									<mat-icon matChipRemove>cancel</mat-icon>
								</mat-chip>
							</mat-chip-list>
						</div>

						<!-- <div class="col-lg-4 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<input matInput placeholder="Voucher No" formControlName="voucherno" />
								<mat-error>Voucher No is
									<strong>required</strong>
								</mat-error>
							</mat-form-field>
						</div> -->



					</div>
					<!-- Tagihan Billing Start -->
					<div class="row">
						<div class="col-lg-5 kt-margin-bottom-20-mobile mat-table__message" [hidden]="isSelectVoucher">
							<p class="font-weight-bold">Tagihan Billing</p>
							<p *ngFor="let list of tagihanBillingData; let i = index" class="font-weight-bolder pl-4"
								[ngClass]=" i % 2 === 0 ? 'bg-gray-od' :''">Unit No :
								{{list.unit}} &nbsp;&nbsp;&nbsp;&nbsp;
								Tagihan :
								{{list.tagihanBill}}
								&nbsp;&nbsp;&nbsp;&nbsp; Bulan : {{list.month}} &nbsp;&nbsp;&nbsp;&nbsp; Tahun :
								{{list.year}}
								&nbsp;&nbsp;&nbsp;&nbsp; Billing :
								{{list.billingNum}}
							</p>
							<p *ngIf="tagihanBillingData.length === 0" class="text-danger font-weight-bolder pl-4">No records data !
							</p>
						</div>
						<div class="trans-setoff col-lg-7 kt-margin-bottom-20-mobile mat-table__message" [hidden]="isTransSetOff">
							<p class="title font-weight-bold" [ngClass]="isOpenPayCond ? 'cek' : ''">Transaction Set Off</p>
							<div class="box-trans row">
								<div class="paid pl-4 col-md-2 d-flex align-items-center">
									<div class=" kt-margin-bottom-20-mobile">
										<mat-checkbox [(ngModel)]="isStatus" (change)="changeStatus()" formControlName="status">Paid
										</mat-checkbox>
									</div>
								</div>
								<div class="payment col-md-5" [hidden]="isOpenPayCond">
									<mat-form-field class="mat-form-field-fluid">
										<!-- <mat-select placeholder="Filter By Status" [formControl]="date.filter.control"> -->
										<mat-select placeholder="Select Payment" [formControl]="checked.control">
											<!-- <mat-option *ngFor="let list of payCondList" [value]="clearAllFilter" -->
											<mat-option *ngFor="let list of payCondList" [value]="list.value"
												(click)="valuePayCond(list.value)">{{
												list.payment }}</mat-option>
										</mat-select>
									</mat-form-field>
								</div>
								<div class="pay-date col-md-5" [hidden]="isOpenDatePayCond">
									<mat-form-field class="mat-form-field-fluid">
										<input matInput [matDatepicker]="crtdt2" placeholder="Payment Date"
											[formControl]="checked.date.control" (dateChange)="voucherDateHandler($event)" />
										<mat-datepicker-toggle matSuffix [for]="crtdt2"></mat-datepicker-toggle>
										<mat-datepicker #crtdt2></mat-datepicker>
										<mat-error>Payment Date is
											<strong>required</strong>
										</mat-error>
									</mat-form-field>
								</div>
							</div>
						</div>
					</div>
					<!-- Tagihan Billing End -->

					<div class="form-group kt-form__group row">
						<div class="col-lg-4 kt-margin-bottom-20-mobile mat-table__message" *ngIf="!ccList.length">
						</div>
						<div class="col-lg-4 kt-margin-bottom-20-mobile mat-table__message" *ngIf="!ccList.length">
						</div>
						<div class="col-lg-4 kt-margin-bottom-20-mobile mat-table__message" *ngIf="!ccList.length">
							<button mat-icon-button color="primary" matTooltip="Add GL" type="button" (click)="addCCEmpty(ccList)">
								<mat-icon>add</mat-icon>
								Add GL Account
							</button>
						</div>
					</div>
					<!-- Multi GL Account START -->
					<!-- GL Account 1 START	-->
					<div class="kt-form" formGroupName="multiGLAccount">
						<div class="mat-table__wrapper">

							<mat-table class="lmat-elevation-z8" mat-table #myTable [dataSource]="ccList" matSort #sort1="matSort"
								matSortDirection="asc" matSortDisabledClear>

								<ng-container matColumnDef="no">
									<mat-cell *matCellDef="let cc; let id = index">{{id + 1}}</mat-cell>
								</ng-container>

								<ng-container matColumnDef="gl">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input type="text" matInput placeholder="GL Account" name="{{id + 1}}"
													[matAutocomplete]="GlAuto" (keyup)="_onKeyupGL($event)" />
												<mat-error>Fill input by selecting the
													given items</mat-error>
												<mat-autocomplete #GlAuto="matAutocomplete">
													<mat-option *ngIf="loading.glaccount">
														<div class="opt-loader">
															<mat-spinner [diameter]="15"></mat-spinner>
														</div>
													</mat-option>
													<mat-option *ngIf="
													!loading.glaccount &&
													!gLListResultFiltered.length
												">Item is empty
													</mat-option>
													<mat-option *ngFor="
													let item of gLListResultFiltered
												" value="{{
													item.acctNo | titlecase
												}} - {{
													item.acctName
														| titlecase
												}}" (click)="
													_setGLAccount(item, ('target' + (id + 1)))
												">
														{{
														item.acctNo | titlecase
														}}
														-
														{{
														item.acctName
														| titlecase
														}}
													</mat-option>
												</mat-autocomplete>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>
								<ng-container matColumnDef="amount">
									<!-- <mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input matInput placeholder="Amount" name="{{id + 1}}" autocomplete="off"
													(input)="changeAmount($event, (id + 1))" formControlName="{{'amount' + (id + 1)}}"
													(keydown)="
												inputKeydownHandler($event)
											" maxlength="30" />
												<span matPrefix>Rp &nbsp;</span>
												<mat-error>Amount is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell> -->
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input matInput placeholder="Amount" name="{{id + 1}}" (input)="changeAmount($event, (id + 1))"
													formControlName="{{'amount' + (id + 1)}}" />
												<span matPrefix>Rp &nbsp;</span>
												<mat-error>Amount is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>


								<ng-container matColumnDef="desc">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<!-- <input matInput placeholder="Description" (change)="valueAmount($event)" name="{{id + 1}}" formControlName="memo" /> -->
												<input matInput placeholder="Description" name="{{id + 1}}"
													formControlName="{{'memo' + (id + 1)}}" />
												<mat-error>Description is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>

								<ng-container matColumnDef="isdebit">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 d-flex flex-row align-items-center kt-margin-bottom-20-mobile">
											<div class="d-flex">
												<div class="d-flex align-items-center">
													<input type="radio" id="{{'Debit' + (id + 1)}}" name="{{(id + 1)}}" value="true"
														[checked]="true" (change)="valueIsDebit($event)" (click)="clickToggle($event)" />
													<label for="{{'Debit' + (id + 1)}}" class="m-0 pl-2">Debit</label><br />
												</div>
												<div class="mx-3 d-flex align-items-center">
													<input type="radio" id="{{'Credit' + (id + 1) }}" name="{{(id + 1)}}" value="false"
														[checked]="false" (change)="valueIsDebit($event)" (click)="clickToggle($event)" />
													<label for="{{'Credit' + (id + 1) }}" class="m-0 pl-2">Credit</label><br />
												</div>
											</div>
										</div>

									</mat-cell>
								</ng-container>

								<ng-container matColumnDef="action">
									<mat-header-cell *matHeaderCellDef>actions</mat-header-cell>
									<mat-cell *matCellDef="let cc; let id = index">

									</mat-cell>
								</ng-container>

								<mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
							</mat-table>

							<!-- Message for empty data -->

						</div>
						<!-- GL Account 1 END	-->
						<!-- GL Account 2 START	-->
						<div class="mat-table__wrapper">

							<mat-table class="lmat-elevation-z8" mat-table #myTable2 [dataSource]="ccList2" matSort #sort1="matSort"
								matSortDirection="asc" matSortDisabledClear>

								<ng-container matColumnDef="no2">
									<mat-cell *matCellDef="let cc; let id = index">{{id + 2}}</mat-cell>
								</ng-container>
								Z
								<ng-container matColumnDef="gl2">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input type="text" matInput placeholder="GL Account" name="{{id + 2}}"
													[matAutocomplete]="GlAuto" (keyup)="_onKeyupGL2($event)" />
												<mat-error>Fill input by selecting the
													given items</mat-error>
												<mat-autocomplete #GlAuto="matAutocomplete">
													<mat-option *ngIf="loading.glaccount">
														<div class="opt-loader">
															<mat-spinner [diameter]="15"></mat-spinner>
														</div>
													</mat-option>
													<mat-option *ngIf="
													!loading.glaccount2 &&
													!gLListResultFiltered2.length
												">Item is empty
													</mat-option>
													<mat-option *ngFor="
													let item of gLListResultFiltered2
												" value="{{
													item.acctNo | titlecase
												}} - {{
													item.acctName
														| titlecase
												}}" (click)="
													_setGLAccount(item, ('target' + (id + 2)))
												">
														{{
														item.acctNo | titlecase
														}}
														-
														{{
														item.acctName
														| titlecase
														}}
													</mat-option>
												</mat-autocomplete>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>
								<ng-container matColumnDef="amount2">
									<!-- <mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input matInput placeholder="Amount" name="{{id + 2}}" autocomplete="off"
													(input)="changeAmount($event, (id + 2))" formControlName="{{'amount' + (id + 2)}}"
													(keydown)="
												inputKeydownHandler($event)
											" maxlength="30" />
												<span matPrefix>Rp &nbsp;</span>
												<mat-error>Amount is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell> -->
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<input matInput placeholder="Amount" name="{{id + 2}}" (input)="changeAmount($event, (id + 2))"
													formControlName="{{'amount' + (id + 2)}}" />
												<span matPrefix>Rp &nbsp;</span>
												<mat-error>Amount is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>


								<ng-container matColumnDef="desc2">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 kt-margin-bottom-20-mobile">
											<mat-form-field class="mat-form-field-fluid">
												<!-- <input matInput placeholder="Description" (change)="valueAmount($event)" name="{{id + 2}}" formControlName="memo" /> -->
												<input matInput placeholder="Description" name="{{id + 2}}"
													formControlName="{{'memo' + (id + 2)}}" />
												<mat-error>Description is
													<strong>required</strong>
												</mat-error>
											</mat-form-field>
										</div>

									</mat-cell>
								</ng-container>

								<ng-container matColumnDef="isdebit2">
									<mat-cell *matCellDef="let cc; let id = index">
										<div class="col-md-12 d-flex flex-row align-items-center kt-margin-bottom-20-mobile">
											<div class="d-flex">
												<div class="d-flex align-items-center">
													<input type="radio" id="{{'Debit' + (id + 2)}}" name="{{(id + 2)}}" value="true"
														[checked]="false" (change)="valueIsDebit($event)" (click)="clickToggle($event)" />
													<label for="{{'Debit' + (id + 2)}}" class="m-0 pl-2">Debit</label><br />
												</div>
												<div class="mx-3 d-flex align-items-center">
													<input type="radio" id="{{'Credit' + (id + 2) }}" name="{{(id + 2)}}" value="false"
														[checked]="true" (change)="valueIsDebit($event)" (click)="clickToggle($event)" />
													<label for="{{'Credit' + (id + 2) }}" class="m-0 pl-2">Credit</label><br />
												</div>
											</div>
										</div>

									</mat-cell>
								</ng-container>

								<ng-container matColumnDef="action2">
									<mat-header-cell *matHeaderCellDef>actions</mat-header-cell>
									<mat-cell *matCellDef="let cc; let id = index">

									</mat-cell>
								</ng-container>

								<mat-row *matRowDef="let row; columns: displayedColumns2"></mat-row>
							</mat-table>

							<!-- Message for empty data -->

						</div>
						<!-- GL Account 2 END	-->

					</div>
					<!-- Multi GL Account END -->


					<div class="form-group kt-form__group row">
						<!-- <div class="col-lg-6 kt-margin-bottom-20-mobile">
							<mat-checkbox [(ngModel)]="isStatus" (change)="changeStatus()" formControlName="status">Paid
							</mat-checkbox>
						</div> -->
						<!-- <div class="col-lg-6 kt-margin-bottom-20-mobile">
							<mat-form-field class="mat-form-field-fluid">
								<mat-select placeholder="Print Size" formControlName="printSize">
									<mat-option *ngFor="let list of printOptions" [value]="list.value">{{ list.name }}</mat-option>
								</mat-select>
								<mat-error>
									Print Size is
									<strong>required</strong>
								</mat-error>
							</mat-form-field>
						</div> -->

					</div>
				</div>
			</form>
		</div>
		<!--end::Form-->
	</kt-portlet-body>
</kt-portlet>